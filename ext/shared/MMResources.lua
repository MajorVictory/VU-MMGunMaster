class "MMResources"

function MMResources:__init()
	self.MMResources = {}


	self.MMResources["gmpreset_0"] = {}
	self.MMResources["gmpreset_0"]["Partition"] = 'F71EE45B-1BB0-4442-A46D-5B079A722230'
	self.MMResources["gmpreset_0"]["Instance"] = 'F0D72AE2-9243-43D4-9070-E97B53430FB8'

	self.MMResources["gmpreset_0_xp4"] = {}
	self.MMResources["gmpreset_0_xp4"]["Partition"] = 'F58C83A7-C753-4360-A9C0-4E44C79836F8'
	self.MMResources["gmpreset_0_xp4"]["Instance"] = '2D869E35-5D5F-4256-B876-C85911F0A7D6'



	self.MMResources["mp443_gm"] = {}
	self.MMResources["mp443_gm"]["Partition"] = 'ED5DEF93-B621-456F-8246-33BFC9E564C2'
	self.MMResources["mp443_gm"]["Instance"] = 'B41C9F21-D723-4607-B2BA-4B2C30677C51'

	self.MMResources["m93r_gm"] = {}
	self.MMResources["m93r_gm"]["Partition"] = '30870A1C-F7BE-494A-B65B-9B0EB380A93C'
	self.MMResources["m93r_gm"]["Instance"] = '08D76B3D-03BB-4B71-8BE3-406B9FDE6B4D'

	self.MMResources["magnum44"] = {}
	self.MMResources["magnum44"]["Partition"] = '584C0B65-BC87-4853-AD28-7B7CEB21B336'
	self.MMResources["magnum44"]["Instance"] = '09C7A2C4-DA0C-4F4C-B1C9-772A66AEB157'

	self.MMResources["pp19"] = {}
	self.MMResources["pp19"]["Partition"] = '983A236F-22EB-11E0-87CC-DAB15BD78BE2'
	self.MMResources["pp19"]["Instance"] = '68BC3068-5698-126B-4C51-3B30F30FEEFA'

	self.MMResources["pp19_bullet"] = {}
	self.MMResources["pp19_bullet"]["Partition"] = '034DE2CA-615D-415A-B94D-7E6BF78BF004'
	self.MMResources["pp19_bullet"]["Instance"] = '1DCD8041-89A8-439E-9914-45B5BB60578F'

	self.MMResources["p90"] = {}
	self.MMResources["p90"]["Partition"] = 'C7D08BC3-04B6-440C-BF99-0E6D6A41D890'
	self.MMResources["p90"]["Instance"] = '4C7904EB-0121-4BE4-B50B-D15E4505BC7E'

	self.MMResources["spas12"] = {}
	self.MMResources["spas12"]["Partition"] = '37F8F2ED-CAC0-42E8-B77B-2300A99C3B0F'
	self.MMResources["spas12"]["Instance"] = '27C36CA8-C16D-4D2B-B3DC-73E7AF91BE85'

	self.MMResources["jackhammer"] = {}
	self.MMResources["jackhammer"]["Partition"] = '014C428F-9A3C-4EA0-9F0C-873058E72438'
	self.MMResources["jackhammer"]["Instance"] = 'C57F6902-E9BE-44B8-BCFA-9FFEB3A9A93C'
	self.MMResources["jackhammer"]["FireFunction1"] = '3D4D9FCA-FD1A-4F7D-B278-C4676ACD15DF'
	self.MMResources["jackhammer"]["FireFunction2"] = '607CF93E-0510-460C-917B-C056A8CADBBC'
	self.MMResources["jackhammer"]["FireFunction3"] = '91D7B0A3-AB80-4B91-96AC-94014C925478'
	self.MMResources["jackhammer"]["FireFunction4"] = '20B53027-2589-465A-A1DF-DA737A940DAE'

	self.MMResources["acwr"] = {}
	self.MMResources["acwr"]["Partition"] = 'E1DE3897-F570-11E0-B897-D25D16CBAAAF'
	self.MMResources["acwr"]["Instance"] = '80D1A454-CD95-2058-96F1-BA9AEE854748'

	self.MMResources["acwrbullets"] = {}
	self.MMResources["acwrbullets"]["Partition"] = 'E951BBE1-971B-4227-9FAE-67386CAE62FD'
	self.MMResources["acwrbullets"]["Instance"] = '69097012-1798-4A9E-904A-1E30B7113ACA'

	self.MMResources["mtar"] = {}
	self.MMResources["mtar"]["Partition"] = '057A5DF0-209C-4C31-880F-479AF453884D'
	self.MMResources["mtar"]["Instance"] = '86687168-663F-4D33-AAD6-D6C5DE5E8F34'

	self.MMResources["40mmlvg_grenade"] = {}
	self.MMResources["40mmlvg_grenade"]["Partition"] = 'FD79A08F-F108-4751-B2C0-6C47397133B5'
	self.MMResources["40mmlvg_grenade"]["Instance"] = '393E4094-C2A2-4DF2-B977-F82E6974A8CB'

	self.MMResources["40mmlvg_grenadeexp"] = {}
	self.MMResources["40mmlvg_grenadeexp"]["Partition"] = 'FD79A08F-F108-4751-B2C0-6C47397133B5'
	self.MMResources["40mmlvg_grenadeexp"]["Instance"] = '5FE2082D-F901-43F2-A822-969CC6857134'

	self.MMResources["aug"] = {}
	self.MMResources["aug"]["Partition"] = '91978925-827B-4DA2-82C1-307ECCB7B83B'
	self.MMResources["aug"]["Instance"] = '8DF97E42-C7F1-4E4D-826E-E9B90206C16E'

	self.MMResources["augbullet"] = {}
	self.MMResources["augbullet"]["Partition"] = '9847CF94-6CC9-4500-BE0F-002E3CAA3637'
	self.MMResources["augbullet"]["Instance"] = '6C055C66-9145-4ECB-8C41-BBE1A6C91287'

	self.MMResources["scarl"] = {}
	self.MMResources["scarl"]["Partition"] = '6695DE67-4178-4EA7-95F9-9D575EF95E2A'
	self.MMResources["scarl"]["Instance"] = '13EB2C92-DC45-4049-8F74-34192ECD2BBE'

	self.MMResources["claymore"] = {}
	self.MMResources["claymore"]["Partition"] = '8709A814-1FF9-11E0-8A74-C88A4F19AAB4'
	self.MMResources["claymore"]["Instance"] = 'AA3BA4F5-2F8E-65FD-016A-D1E6F8C870FB'

	self.MMResources["claymoreexp"] = {}
	self.MMResources["claymoreexp"]["Partition"] = '8709A814-1FF9-11E0-8A74-C88A4F19AAB4'
	self.MMResources["claymoreexp"]["Instance"] = '5120E4F0-CD8C-4926-A45C-DA4460865508'

	self.MMResources["l86"] = {}
	self.MMResources["l86"]["Partition"] = '0BF57B31-9632-484F-8922-0BD476C5FF62'
	self.MMResources["l86"]["Instance"] = 'AF6D3176-1825-4EAE-9496-B4CEAC61F238'

	self.MMResources["hk417"] = {}
	self.MMResources["hk417"]["Partition"] = 'E9658C2B-DE00-413D-B63B-BC3504652373'
	self.MMResources["hk417"]["Instance"] = '77986281-3AE9-4DE1-89F4-E128CF510199'

	self.MMResources["jng90"] = {}
	self.MMResources["jng90"]["Partition"] = '8C663DDE-525E-4A4D-8D88-7CA1970E59D7'
	self.MMResources["jng90"]["Instance"] = 'D983A8A9-A0A5-45E4-920E-6A9B14EFE7C5'

	self.MMResources["mortar"] = {}
	self.MMResources["mortar"]["Partition"] = '5350B268-18C9-11E0-B820-CD6C272E4FCC'
	self.MMResources["mortar"]["Instance"] = '145C4108-7660-1329-4599-4402DA4801A0'

	self.MMResources["mortarexp"] = {}
	self.MMResources["mortarexp"]["Partition"] = '5350B268-18C9-11E0-B820-CD6C272E4FCC'
	self.MMResources["mortarexp"]["Instance"] = '4827959A-8A3B-4C9F-994E-E54150AA565F'

	self.MMResources["40mmlvg"] = {}
	self.MMResources["40mmlvg"]["Partition"] = 'A2BD3F80-0474-11E0-8A24-DDC0A9242026'
	self.MMResources["40mmlvg"]["Instance"] = 'DCFE8B49-493D-2586-0195-BD4F35BB8197'

	self.MMResources["40mmlvgfire"] = {}
	self.MMResources["40mmlvgfire"]["Partition"] = '0782833F-E28E-417F-8D25-350D504EBEAA'
	self.MMResources["40mmlvgfire"]["Instance"] = 'B287AFC7-2597-4C5A-A2B8-D0F8D43018C4'



	self.MMResources["ammobag"] = {}
	self.MMResources["ammobag"]["Partition"] = '04CD683B-1F1B-11E0-BBD1-F7235575FD24'
	self.MMResources["ammobag"]["Instance"] = '4AE515CE-846D-6070-5F56-1285B7E8E187'

	self.MMResources["magnum44aim"] = {}
	self.MMResources["magnum44aim"]["Partition"] = '5DEFA236-40CF-48CF-8EA8-C1C0093F3013'
	self.MMResources["magnum44aim"]["Instance"] = '8BDECEC7-453B-4A88-87B4-A23D20C4147E'

	self.MMResources["zoom20x"] = {}
	self.MMResources["zoom20x"]["Partition"] = '609CC1AC-4B36-4197-B1C1-2357E57CEBAF'
	self.MMResources["zoom20x"]["Instance"] = '34C9BF53-1E0C-42D3-9EC1-696421E8A420'

	self.MMResources["12gfrag"] = {}
	self.MMResources["12gfrag"]["Partition"] = '2A6FCD72-5842-41B4-AC48-56BAACA506A3'
	self.MMResources["12gfrag"]["Instance"] = 'EF265029-3291-4544-8081-ABFFA09D3D96'

	self.MMResources["c4"] = {}
	self.MMResources["c4"]["Partition"] = '90D317AC-2554-11E0-9BE1-9E3A551FF0D1'
	self.MMResources["c4"]["Instance"] = '6CF717B6-188A-4AE7-A1D2-CC1A2333C0D7'

	self.MMResources["c4exp"] = {}
	self.MMResources["c4exp"]["Partition"] = '910AD7C5-2558-11E0-96DC-FF63A5537869'
	self.MMResources["c4exp"]["Instance"] = '5FE6E2AD-072E-4722-984A-5C52BC66D4C1'

	self.MMResources["c4expentity"] = {}
	self.MMResources["c4expentity"]["Partition"] = '910AD7C5-2558-11E0-96DC-FF63A5537869'
	self.MMResources["c4expentity"]["Instance"] = '09DCA5BB-BB2E-4EC6-B07F-5F74863EB458'

	self.MMResources["smaw"] = {}
	self.MMResources["smaw"]["Partition"] = 'BCE98CA0-17EC-11E0-8CD8-85483A75A7C5'
	self.MMResources["smaw"]["Instance"] = 'AB8577C5-D5F9-4A17-BEB2-2E153E171630'

	self.MMResources["smawmissile"] = {}
	self.MMResources["smawmissile"]["Partition"] = '168F529B-17F6-11E0-8CD8-85483A75A7C5'
	self.MMResources["smawmissile"]["Instance"] = '168F529C-17F6-11E0-8CD8-85483A75A7C5'

	self.MMResources["bullet338"] = {}
	self.MMResources["bullet338"]["Partition"] = '2056BCC7-3769-458C-8C0E-BB6280DF360C'
	self.MMResources["bullet338"]["Instance"] = '1BF6EA67-2EFE-4B93-9558-0B3B38862E1F'

	self.MMResources["m98"] = {}
	self.MMResources["m98"]["Partition"] = '84BA0CE7-1755-11E0-B7E4-E4E608316920'
	self.MMResources["m98"]["Instance"] = '7805C312-2B2B-49C6-B1A9-F6A99863BA3E'

	self.MMResources["aek971"] = {}
	self.MMResources["aek971"]["Partition"] = '64DB81AD-1F08-11E0-BE14-C6BC4F4ED27B'
	self.MMResources["aek971"]["Instance"] = 'CE3372DA-991B-41C1-95BC-19B5D26AAE5B'

	self.MMResources["rpgprojectile"] = {}
	self.MMResources["rpgprojectile"]["Partition"] = '6C857FD9-6FB3-11DE-B35E-864CF572E1C4'
	self.MMResources["rpgprojectile"]["Instance"] = 'CDD3A384-8243-A258-E23D-239CC0D52698'

	self.MMResources["knoife"] = {}
	self.MMResources["knoife"]["Partition"] = 'B6CDC48A-3A8C-11E0-843A-AC0656909BCB'
	self.MMResources["knoife"]["Instance"] = 'F21FB5EA-D7A6-EE7E-DDA2-C776D604CD2E'

	self.MMResources["crossbolt"] = {}
	self.MMResources["crossbolt"]["Partition"] = '26076E01-A015-44A8-BFBF-695187E25FFB'
	self.MMResources["crossbolt"]["Instance"] = '391BB7D5-C4AE-4952-B103-189DC1700030'

	self.MMResources["crossboltsound"] = {}
	self.MMResources["crossboltsound"]["Partition"] = '591449E1-A47A-4768-A7A8-29DE293517E8'
	self.MMResources["crossboltsound"]["Instance"] = '3C39A1D9-F161-4A4B-A065-9C70D13DBB81'

	self.MMResources["crossbolt_he"] = {}
	self.MMResources["crossbolt_he"]["Partition"] = '07E407B3-A4FE-4CD1-BABA-D8F6EB59FAEA'
	self.MMResources["crossbolt_he"]["Instance"] = 'D09E04C4-4B06-4967-A7F5-1DE6D0912676'

	self.MMResources["m60"] = {}
	self.MMResources["m60"]["Partition"] = '99BD41C7-EDB0-11DF-A0C6-D95650B9E286'
	self.MMResources["m60"]["Instance"] = '1D44B441-7F16-46F3-9EFF-D0647D554EFE'

	self.MMResources["famas"] = {}
	self.MMResources["famas"]["Partition"] = '706A1BD6-6DAB-4CEE-BFCA-82814251E2D8'
	self.MMResources["famas"]["Instance"] = 'F91A9BA8-A08B-44EE-B6F3-9B181FAD71BA'



	self.MMResources["playerphys"] = {}
	self.MMResources["playerphys"]["Partition"] = '235CD1DA-8B06-4A7F-94BE-D50DA2D077CE'
	self.MMResources["playerphys"]["Instance"] = 'A10FF2AA-F3CF-416B-A79B-E8C5416A9EBC'

	self.MMResources["yump"] = {}
	self.MMResources["yump"]["Partition"] = '235CD1DA-8B06-4A7F-94BE-D50DA2D077CE'
	self.MMResources["yump"]["Instance"] = '3129BCFE-000E-4001-9F8F-316E5835C9FC'

	self.MMResources["pose_stand"] = {}
	self.MMResources["pose_stand"]["Partition"] = '235CD1DA-8B06-4A7F-94BE-D50DA2D077CE'
	self.MMResources["pose_stand"]["Instance"] = '69A866A2-DF7C-4BAD-B55F-99536F2551F6'

	self.MMResources["pose_standair"] = {}
	self.MMResources["pose_standair"]["Partition"] = '235CD1DA-8B06-4A7F-94BE-D50DA2D077CE'
	self.MMResources["pose_standair"]["Instance"] = 'DF7475F9-216E-48C3-AED1-5483EFA3BB15'

	self.MMResources["pose_swimming"] = {}
	self.MMResources["pose_swimming"]["Partition"] = '235CD1DA-8B06-4A7F-94BE-D50DA2D077CE'
	self.MMResources["pose_swimming"]["Instance"] = 'C3755191-6B9F-4B88-8677-59488AFC7530'

	self.MMResources["pose_climbing"] = {}
	self.MMResources["pose_climbing"]["Partition"] = '235CD1DA-8B06-4A7F-94BE-D50DA2D077CE'
	self.MMResources["pose_climbing"]["Instance"] = 'AF7A12E9-D79A-4856-8C03-3C88DF1ED8A6'

	self.MMResources["pose_chute"] = {}
	self.MMResources["pose_chute"]["Partition"] = '235CD1DA-8B06-4A7F-94BE-D50DA2D077CE'
	self.MMResources["pose_chute"]["Instance"] = 'F39A8591-BA69-4BE9-B289-B2A0B336A7EE'




	for resourceName, resourceData in pairs(self.MMResources) do
		self.MMResources[resourceName].Loaded = false
	end
end


function MMResources:IsLoaded(resourceName)
	if not self.MMResources[resourceName] then
		print("Tried to check unregistered resource: "..tostring(resourceName))
		return false
	else
		return self.MMResources[resourceName].Loaded
	end
end

function MMResources:SetLoaded(resourceName, value)
	if not self.MMResources[resourceName] then
		print("Tried to set unregistered resource: "..tostring(resourceName))
	else
		self.MMResources[resourceName].Loaded = value
	end
end

function MMResources:Get(resourceName)
	if (resourceName ~= nil) then
		return self.MMResources[resourceName]
	else
		return self.MMResources
	end
end

function MMResources:GetMap(guid)
	if (guid ~= nil) then
		return self.MapLookup[guid:ToString('D')]
	else
		return self.MapLookup
	end
end

function MMResources:GetPartition(resourceName)
	return ResourceManager:FindDatabasePartition(Guid(self.MMResources[resourceName].Partition))
end

function MMResources:GetInstance(resourceName, secondaryResource)
	if (secondaryResource ~= nil) then
		return ResourceManager:FindInstanceByGuid(Guid(self.MMResources[resourceName].Partition), Guid(self.MMResources[resourceName][secondaryResource]))
	else
		return ResourceManager:FindInstanceByGuid(Guid(self.MMResources[resourceName].Partition), Guid(self.MMResources[resourceName].Instance))
	end
end

function MMResources:AddToPartition(resourceName, partition)
	if not self.MMResources[resourceName] then
		print("Tried to add unregistered resource to partition: "..tostring(resourceName))
		return
	end

    print('Adding '..resourceName..' instances to partition...')
    self.MMResources[resourceName].Register = true
	local resourceData = self.MMResources[resourceName]

	if (resourceData.Entities) then
        print("Adding Entities ["..resourceName.."]...")
        for i = 1, #resourceData.Entities do
            local res = ResourceManager:SearchForInstanceByGuid(Guid(resourceData.Entities[i]))
            if (res) then
                print("["..i.."] Added: "..res.typeInfo.name)
                partition:AddInstance(res)
            else
                print("["..i.."] Failed: "..resourceData.Entities[i])
            end
        end
    end
    if (resourceData.Blueprints) then
        print("Adding Blueprints ["..resourceName.."]...")
        for i = 1, #resourceData.Blueprints do
            local res = ResourceManager:SearchForInstanceByGuid(Guid(resourceData.Blueprints[i]))
            if (res) then
                print("["..i.."] Added: "..res.typeInfo.name)
                partition:AddInstance(res)
            else
                print("["..i.."] Failed: "..resourceData.Blueprints[i])
            end
        end
    end
    if (resourceData.LogicReferrence) then
        print("Adding Logic Referrences ["..resourceName.."]...")
        for i = 1, #resourceData.LogicReferrence do
            local res = ResourceManager:SearchForInstanceByGuid(Guid(resourceData.LogicReferrence[i]))
            if (res) then
                print("["..i.."] Added: "..res.typeInfo.name)
                partition:AddInstance(res)
            else
                print("["..i.."] Failed: "..resourceData.LogicReferrence[i])
            end
        end
    end
end

function MMResources:CreateRegistryContainer()
	local resourceContainer = RegistryContainer()
    
    print('Creating instance registry...')
    local registrySize = 0

    for resourceName, resourceData in pairs(self.MMResources) do
    	if (resourceData.Register) then 
	        if (resourceData.Entities) then
	            print("Adding Entities ["..resourceName.."]...")
	            for i = 1, #resourceData.Entities do
	                local res = ResourceManager:SearchForInstanceByGuid(Guid(resourceData.Entities[i]))
	                if (res) then
	                    print("["..i.."] Added: "..res.typeInfo.name)
	                    resourceContainer.entityRegistry:add(res)
	                    registrySize = registrySize+1
	                else
	                    print("["..i.."] Failed: "..resourceData.Entities[i])
	                end
	            end
	        end
	        if (resourceData.Blueprints) then
	            print("Adding Blueprints ["..resourceName.."]...")
	            for i = 1, #resourceData.Blueprints do
	                local res = ResourceManager:SearchForInstanceByGuid(Guid(resourceData.Blueprints[i]))
	                if (res) then
	                    print("["..i.."] Added: "..res.typeInfo.name)
	                    resourceContainer.blueprintRegistry:add(res)
	                    registrySize = registrySize+1
	                else
	                    print("["..i.."] Failed: "..resourceData.Blueprints[i])
	                end
	            end
	        end
	        if (resourceData.LogicReferrence) then
	            print("Adding Logic Referrences ["..resourceName.."]...")
	            for i = 1, #resourceData.LogicReferrence do
	                local res = ResourceManager:SearchForInstanceByGuid(Guid(resourceData.LogicReferrence[i]))
	                if (res) then
	                    print("["..i.."] Added: "..res.typeInfo.name)
	                    resourceContainer.referenceObjectRegistry:add(res)
	                    registrySize = registrySize+1
	                else
	                    print("["..i.."] Failed: "..resourceData.LogicReferrence[i])
	                end
	            end
	        end
	    end
    end
    if (registrySize > 0) then
    	return resourceContainer
    else
    	return
    end
end


function MMResources:IsSturdifyBlacklisted(instance)
	if (instance:Is('VehicleEntityData')) then
		local vehicleData = VehicleEntityData(instance)

		return (self.SturdifyBlacklist[instance.instanceGuid:ToString('D')] == true or vehicleData.nameSid == '' or self.SturdifyBlacklist[vehicleData.nameSid] == true)
	else
		return self.SturdifyBlacklist[instance.instanceGuid:ToString('D')] == true
	end
end

function MMResources:IsHelicopter(instance)
	local vehicleBlueprint = VehicleBlueprint(instance)
	return self.HeliLookup[vehicleBlueprint.name] == true
end

function MMResources:ScaleTransforms(transformList, scale)

	if (transformList == nil or #transformList < 1) then 
		return
	end
	if (scale == nil) then 
		scale = 1
	end

	for i=1, #transformList do

		local transform = nil

		if (transformList[i].typeInfo.name ~= 'LinearTransform' and transformList[i].transform) then 
			transform = transformList[i].transform
		else 
			transform = transformList[i]
		end

		if (transform.left == nil) then
			transform.right = transform.right * scale
		else
			transform.left.x = scale
		end

		transform.up.y = scale
		transform.forward.z = scale

		transform.trans.x = transform.trans.x * scale
		transform.trans.y = transform.trans.y * scale
		transform.trans.z = transform.trans.z * scale
	end

end

return MMResources()